<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[lkdjiin's blog]]></title>
  <link href="http://lkdjiin.github.io/atom.xml" rel="self"/>
  <link href="http://lkdjiin.github.io/"/>
  <updated>2013-10-06T21:02:11+02:00</updated>
  <id>http://lkdjiin.github.io/</id>
  <author>
    <name><![CDATA[Xavier Nayrac]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Le métier de copiste musical]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/06/le-metier-de-copiste-musical/"/>
    <updated>2013-10-06T20:58:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/06/le-metier-de-copiste-musical</id>
    <content type="html"><![CDATA[<p>Pour changer un peu de l&#8217;informatique et comme on est dimanche, je vous
présente aujourd&#8217;hui le métier de copiste musical.</p>

<!-- more -->


<p>En quelques mots, un copiste musical se charge de mettre votre musique sur
partition. Doté d&#8217;une très bonne oreille, il travaille généralement à partir
d&#8217;un enregistrement audio et transcrit votre musique pour vous. Le
produit fini est souvent dans un format imposé par la SACEM.
Il peut aussi travailler avec un imprimeur et/ou un graphiste pour
produire, par exemple un songbook de vos chansons.</p>

<p>Un copiste musical vous sera utile si vous avez besoin de mettre votre
musique sur partition mais que vous ne connaissez pas le solfège, ou encore
si vous n&#8217;en avez pas le temps, si vous voulez que ça aie l&#8217;air vraiment
pro, etc.
J&#8217;ai une amie dont c&#8217;est le métier, vous pouvez voir son site ici:
<a href="http://www.la-copiste-musicale.com/">la-copiste-musicale.com</a>.</p>

<p>À demain.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Gem Ruby: Tracez vos fonctions et données en 2D avec ctioga2]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/05/gem-ruby-tracez-vos-fonctions-et-donnees-en-2d-avec-ctioga2/"/>
    <updated>2013-10-05T14:43:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/05/gem-ruby-tracez-vos-fonctions-et-donnees-en-2d-avec-ctioga2</id>
    <content type="html"><![CDATA[<p>Je cherchais un programme simple à prendre en main pour tracer des
ensembles de données depuis un fichier et des fonctions mathématiques
et je suis tombé sur la gem <a href="http://ctioga2.rubyforge.org/index.html">ctioga2</a>.</p>

<p><img src="http://lkdjiin.github.io/images/ctioga2.png"></p>

<p>Voici une introduction rapide à ce programme de traçage.</p>

<!-- more -->


<h2>Installation</h2>

<p>Il faut d&#8217;abord installer les outils nécessaires à la génération de document
pdf. Sur Linux c&#8217;est texlive, pour les autres OS voyez la
<a href="http://ctioga2.rubyforge.org/install.html">page d&#8217;installation</a> de ctioga2.
Ensuite on installe la gem comme d&#8217;habitude:</p>

<pre><code>gem install ctioga2
</code></pre>

<h2>Le fichier de données</h2>

<p>Un commentaire commence par un <code>#</code>. La première colonne est la coordonnée <code>x</code> et
la seconde colonne est la coordonnée <code>y</code>. Difficile de faire plus simple.
Un exemple:</p>

<pre><code># Fichier data.dat
# x y
0 -0.9
1 -0.4
2 -0.1
3 0.1
4 0.4
5 0.9
</code></pre>

<h2>Les scripts</h2>

<p>Voici un script minimal pour générer un fichier pdf:</p>

<pre><code># Fichier test.ct2
xpdf
plot data.dat
title 'Test'
</code></pre>

<p>Ce script va générer un fichier au format pdf à partir de notre fichier
de données, avec le titre <code>Test</code>. On le lance ainsi:</p>

<pre><code>ctioga2 -f test.ct2
</code></pre>

<p><strong>Note</strong> j&#8217;ai trouvé que seuls les caractères ascii fonctionnaient pour le
titre.</p>

<p>Si notre fichier de données possèdent plusieurs colonnes, on peut tracer
plusieurs courbes ainsi:</p>

<pre><code># Fichier test.ct2
xpdf
plot data.dat
plot data.dat@1:3
title 'Test'
</code></pre>

<p>Par défaut les <code>x</code> proviennent de la 1ère colonne et les <code>y</code> de la seconde.
La ligne <code>plot data.dat@1:3</code> trace une seconde courbe avec les <code>y</code> venant
de la 3ème colonne.</p>

<p>On peut aussi fournir des expressions Ruby:</p>

<pre><code>plot data2.dat@'$2:$3**2'
</code></pre>

<p>Ici la seconde colonne est utilisée pour les <code>x</code> et les <code>y</code> proviennent de
la troisième colonne, dont les données sont élevées à la puissance 2.</p>

<p>Plein d&#8217;autres choses sont possibles, comme produire du format png ou
svg, spécifier la portée des coordonnées x et y, utiliser le programme
en ligne de commande, etc.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash/'>Ruby: un exemple de valeur par défaut pour un Hash</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 28]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/"/>
    <updated>2013-10-04T18:43:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Dans le <a href="http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/">dernier article</a> on a vu quelle forme concrete prenait un extremum
local dans nos algorithmes génétiques: les chromosomes tendent à devenir
identiques. On doit maintenant comprendre pourquoi on bloque sur un
extremum local dans ce problème particulier des 8 dames, alors qu&#8217;on avait
bien supprimé ce souci dans le <a href="http://lkdjiin.github.io/blog/2013/09/08/les-algorithmes-genetiques-demystifies-8-le-paradoxe-du-singe-savant/">paradoxe du singe savant</a>.</p>

<!-- more -->


<p>On reprend <a href="http://lkdjiin.github.io/blog/2013/09/18/les-algorithmes-genetiques-demystifies-17-oriente-objet/">le code</a> pour le paradoxe du singe savant et on modifie
la méthode <code>run</code> de la classe <code>GeneticAlgorithm</code> pour inspecter l&#8217;état des
chromosomes une fois la solution trouvée:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">run</span>
</span><span class='line'>    <span class="vi">@generations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">generation</span><span class="o">|</span>
</span><span class='line'>      <span class="no">Evaluator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@search_value</span><span class="p">,</span> <span class="vi">@population</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span>
</span><span class='line'>      <span class="n">best</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">best</span>
</span><span class='line'>      <span class="c1"># display(generation, best)</span>
</span><span class='line'>      <span class="c1"># exit if best.score == @search_value.size</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">best</span><span class="o">.</span><span class="n">score</span> <span class="o">==</span> <span class="vi">@search_value</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>        <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="nb">p</span> <span class="n">i</span><span class="o">.</span><span class="n">chromosome</span><span class="p">}</span>
</span><span class='line'>        <span class="nb">exit</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">next_generation</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>En se servant du <a href="http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/">petit script d&#8217;analyse</a> du dernier article, vous vous
apercevrez que pratiquement chaque chromosome est unique. Pourquoi cela
fonctionne ici et pas là ?</p>

<p>Lorsque, dans le paradoxe du singe savant, on mute une phrase, chaque
mutation a une chance réelle d&#8217;améliorer la phrase. Bien sûr, pour améliorer
la phrase, il faut que toutes les conditions soit réunies. Il faut
premièrement, que le gène qui mute soit un «mauvais» gène et deuxièmement,
que le remplaçant soit un «bon» gène. Par contre, quelque soit le gène
mutant, les autres gènes n&#8217;entrent pas en ligne de compte. Dans la phrase,
chaque gène est totalement indépendant des autres. Voici un exemple pour
clarifier mon propos. On cherche la phrase &ldquo;bonjour&rdquo; et on a pour l&#8217;instant
ceci:</p>

<pre><code>xxxxxxx
</code></pre>

<p>Cette phrase n&#8217;a que des mauvais gènes, son score est de zéro. Si on mute
le premier gène en &ldquo;b&rdquo;:</p>

<pre><code>bxxxxxx
</code></pre>

<p>La phrase s&#8217;est améliorée, son score a augmenté. Vous remarquez que quelque soit
les autres gènes, bons ou mauvais, le score augmente de toutes manières de 1.
C&#8217;est ce que j&#8217;appelle des <em>gènes indépendants</em>.</p>

<p>Dans le problème des 8 dames, c&#8217;est très différent. Il me manque malheureusement
les outils mathématiques et/ou statistiques pour conceptualiser tout ça mais
je vais néanmoins essayer d&#8217;expliquer. Lorsqu&#8217;on déplace une dame sur le
plateau, c&#8217;est à dire quand un gène mute, son déplacement à un effet
potentiel sur les autres dames, elle peut entrer en conflit avec une ou
plusieurs. Donc dans le problème des 8 dames les gènes sont dépendants les
uns des autres. On ne peut pas en muter un sans affecter <em>potentiellement</em>
les autres. Ça signifie qu&#8217;il doit y avoir certains chromosomes pour lequels
la mutation d&#8217;un seul gène, quel qu&#8217;il soit (ou même de plusieurs en
augmentant la taille de l&#8217;échiquier), ne peut pas améliorer ce chromosome.
Comme le taux de mutation doit être petit pour permettre
<a href="http://lkdjiin.github.io/blog/2013/10/01/les-algorithmes-genetiques-demystifies-exploration-vs-exploitation/">l&#8217;exploitation</a> des chromosomes, la probabilité qu&#8217;un chromosome voit
suffisament de ses gènes mutés comme il faut est infime, quasi-inexistante.</p>

<p>J&#8217;espère avoir été suffisament clair, n&#8217;hésitez pas à me demander des précisions
le cas échéant, je ferais de mon mieux pour y répondre. Je vous proposerais
une solution dans le prochain article.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/'>Les algorithmes génétiques démystifiés 24</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/26/les-algorithmes-genetiques-demystifies-23/'>Les algorithmes génétiques démystifiés 23</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby: un exemple de valeur par défaut pour un Hash]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash/"/>
    <updated>2013-10-03T10:52:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-1'>Niveau : <span>facile</span></div>


<p>J&#8217;oublie régulièrement qu&#8217;un Hash peut renvoyer une valeur par défaut.
Du coup, je me retrouve souvent avec un code inutilement lourd.
Aujourd&#8217;hui je montre un exemple d&#8217;initialisation d&#8217;un Hash avec une
valeur par défaut et pourquoi c&#8217;est intéressant.</p>

<!-- more -->


<p>Dans <a href="http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/">l&#8217;article d&#8217;hier</a>
(sur les algorithmes génétiques) je donnais un script de trois lignes sans
fournir d&#8217;explications, les voici.</p>

<h2>L&#8217;objectif</h2>

<p>J&#8217;ai un fichier (&ldquo;mots.txt&rdquo;) contenant un certain nombre de mots pouvant
apparaitre plusieurs fois:</p>

<pre><code>casserole
casserole
assiette
fourchette
casserole
fourchette
verre
...
</code></pre>

<p>Je veux connaitre le nombre d&#8217;occurence de chaque mot et produire une sortie
de ce genre:</p>

<pre><code>187 =&gt; casserole
 13 =&gt; assiette
  2 =&gt; fourchette
  1 =&gt; verre
</code></pre>

<h2>La classe Hash expliquée en 30 secondes</h2>

<p><em>Si vous savez déjà ce qu&#8217;est un hash, passez directement à la section
suivante.</em></p>

<p>Un <em>hash</em> peut contenir un nombre indeterminé de paires d&#8217;objets ; ces paires
étants organisées en clé/valeur. Ça marche comme un dictionnaire. Dans
d&#8217;autres langages, vous les connaissez peut-être sous le nom de dict, map,
tableau associatif, hashtable, etc. En Ruby, on peut créer un hash vide de
deux façons:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'><span class="n">autre_hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span>
</span></code></pre></td></tr></table></div></figure>


<p>On peut créer et remplir un hash en même temps:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;clef1&quot;</span> <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;clef2&quot;</span> <span class="o">=&gt;</span> <span class="mi">456</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pour connaitre la valeur associée à la clé &ldquo;clef1&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span><span class="o">[</span><span class="s2">&quot;clef1&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pour modifier la valeur associée à la clé &ldquo;clef1&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span><span class="o">[</span><span class="s2">&quot;clef1&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pour ajouter une paire clé/valeur:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span><span class="o">[</span><span class="s2">&quot;nouvelle clef&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="mi">123546789</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notez que les clés et leurs valeurs peuvent être de n&#8217;importe quel type.
On n&#8217;est pas limité à des chaînes de caractères et des nombres.</p>

<h2>Première version</h2>

<p>Mon premier jet a donné ceci:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Version 1</span>
</span><span class='line'>
</span><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;mots.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each_line</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span>
</span><span class='line'>  <span class="k">if</span> <span class="nb">hash</span><span class="o">.</span><span class="n">key?</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">=</span> <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">hash</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="s2">&quot;%3d&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">#{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>La première ligne crée un hash vide tandis que la dernière affiche
le contenu du hash, formaté comme je le veux. Au milieu, on itère sur
les lignes du fichier texte (les mots) pour remplir le hash,
c&#8217;est ça qui m&#8217;intéresse:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">if</span> <span class="nb">hash</span><span class="o">.</span><span class="n">key?</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">=</span> <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>C&#8217;est une construction classique à base de if/else. Si le hash possède
une clé identique à la ligne en cours (<code>if hash.key?(line)</code>) alors on
incrémente sa valeur associée. Sinon on crée cette clé, associée à la
valeur 1 puisque c&#8217;est la première fois qu&#8217;on rencontre ce mot
(<code>hash[line] = 1</code>).</p>

<h2>Deuxième version</h2>

<p>Ruby possède un opérateur ternaire (<em>ternary operator</em>) qui peut remplacer
un if/else simple comme le notre:</p>

<pre><code>condition ? oui : non
</code></pre>

<p>Si <code>condition</code> est vérifiée, on execute <code>oui</code>, sinon on execute <code>non</code>.
Dans notre cas on peut donc écrire:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;mots.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each_line</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">=</span> <span class="nb">hash</span><span class="o">.</span><span class="n">key?</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="p">?</span> <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Certains adorent ce genre de construction, d&#8217;autres détestent. <em>À priori</em> je
n&#8217;ai rien contre, mais il faut avouer que dans ce cas précis c&#8217;est tout
simplement illisible.</p>

<h2>Troisième version</h2>

<p>Ruby possède un opérateur sympa qu&#8217;on peut parfois utiliser quand on veut
initialiser une variable si elle n&#8217;existe pas où la modifier si elle
existe: <code>||=</code>. Il faut savoir qu&#8217;un hash renvoie la valeur <code>nil</code> quand on
lui fournit une clé inexistante:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;result.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each_line</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">||=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>hash[line] ||= 0</code> va créer la clé et lui donner la valeur 0 si cette clé
n&#8217;existe pas, sinon la clé se voit affecter sa valeur. Ensuite la valeur de
la clé est incrémentée avec <code>hash[line] += 1</code>. Je trouve cela plus lisible
que la version avec l&#8217;opérateur ternaire, mais moins lisible que la version
avec le if/else, car cela fait appel à un «truc».</p>

<h2>Quatrième et dernière version</h2>

<p>Voici la <em>bonne</em> version (selon moi bien entendu). Il faut modifier
légerement la création du hash:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;result.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each_line</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Quand vous créer un hash, vous pouvez lui dire: «Je veux que tu renvois
telle valeur quand on te donne une clé inexistante». Dans notre cas, les
clés inexistantes renverront toujours zéro. Le tour est joué: une simple
incrémentation suffit maintenant, qu&#8217;une clé existe déjà ou non.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/29/ruby-les-methodes-du-module-kernel-3/'>Ruby: Les méthodes du module Kernel 3</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/28/ruby-les-methodes-du-module-kernel-2/'>Ruby: Les méthodes du module Kernel 2</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/21/ruby-les-methodes-du-module-kernel/'>Ruby: Les méthodes du module Kernel</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 27]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/"/>
    <updated>2013-10-02T12:06:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Maintenant qu&#8217;on a vu ce qu&#8217;était <em>en théorie</em> un extremum local, on
regarde <em>en pratique</em> comment il se manifeste dans les algorithmes
génétiques.</p>

<!-- more -->


<h2>Comment un extremum local se manifeste dans les algorithmes génétiques ?</h2>

<p>On va reprendre le <a href="http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/">dernier code</a>
sur le problème des 8 dames et modifier deux ou trois petites choses.
D&#8217;abord on s&#8217;assure d&#8217;avoir des soucis en passant la taille de l&#8217;échiquier
à 16, et on réduit le nombre de générations pour ne pas avoir à attendre
trop longtemps, 200 semble un bon compromis:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">generations</span> <span class="o">=</span> <span class="mi">200</span>
</span><span class='line'><span class="n">board_size</span> <span class="o">=</span> <span class="mi">16</span>
</span></code></pre></td></tr></table></div></figure>


<p>Puis on modifie la méthode <code>run</code> de la classe <code>GeneticAlgorithm</code> de cette
manière:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">run</span>
</span><span class='line'>  <span class="vi">@generations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">generation</span><span class="o">|</span>
</span><span class='line'>    <span class="no">Evaluator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@board_size</span><span class="p">,</span> <span class="vi">@population</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span>
</span><span class='line'>    <span class="n">best</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">best</span>
</span><span class='line'>    <span class="c1"># display(generation, best)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">best</span><span class="o">.</span><span class="n">score</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'>      <span class="n">best</span><span class="o">.</span><span class="n">display</span>
</span><span class='line'>      <span class="nb">exit</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">next_generation</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="nb">p</span> <span class="n">individual</span><span class="o">.</span><span class="n">chromosome</span> <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>La nouveauté est la ligne suivante:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="nb">p</span> <span class="n">individual</span><span class="o">.</span><span class="n">chromosome</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ainsi, au bout de 200 générations, on affiche la liste des chromosomes.
Pour ceux qui ne connaisse pas Ruby, <code>p x</code> est un raccourci pour
<code>puts x.inspect</code>.</p>

<p>J&#8217;ai aussi pris soin de commenter la ligne <code>display(generation, best)</code>
pour pouvoir enregistrer plus tard le résultat dans un fichier sans que
celui-ci soit pollué par des données inutiles.</p>

<p>Quand on lance le programme, on obtient quelque chose comme ça:</p>

<pre><code>[~/genetic]⇒ ruby 8_queens.rb
[10, 8, 5, 11, 2, 0, 15, 6, 9, 13, 1, 4, 14, 7, 14, 3]
[10, 8, 5, 11, 2, 0, 15, 6, 9, 13, 1, 4, 14, 7, 11, 3]
[10, 8, 5, 11, 2, 0, 15, 12, 9, 13, 1, 4, 14, 7, 14, 3]
[10, 8, 5, 11, 2, 0, 15, 6, 9, 13, 1, 4, 14, 7, 11, 3]
[10, 8, 5, 11, 2, 0, 15, 6, 9, 13, 1, 4, 14, 7, 14, 3]
...
</code></pre>

<p>Les chromosomes sont tous identiques, ou presque ! Pour savoir à quel
point ils sont identiques, on peut les compter à la main (!?) où écrire
un petit script de trois lignes:</p>

<figure class='code'><figcaption><span>8_queens_stat.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="no">ARGV</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">each_line</span> <span class="p">{</span><span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="nb">hash</span><span class="o">[</span><span class="n">line</span><span class="o">]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="p">}</span>
</span><span class='line'><span class="nb">hash</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="s2">&quot;%3d&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">#{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Edit 3 octobre 2013</strong> Si vous ne comprenez pas le script ci-dessus,
voici <a href="http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash/">une explication</a>.</p>

<p>L&#8217;explication de ce script dépasse le cadre de cet article, l&#8217;objectif
étant de savoir combien de chromosomes sont identiques. Pour cela on
refait tourner notre algorithme génétique en enregistrant le résultat
(c&#8217;est à dire la liste des chromosomes après 200 générations) dans un
fichier:</p>

<pre><code>[~/genetic]⇒ ruby 8_queens.rb &gt; result.txt
</code></pre>

<p>Puis on fait travailler notre script sur ce fichier:</p>

<pre><code>[~/genetic]⇒ ruby 8_queens_stat.rb result.txt
971 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 2, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 8, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 12, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 0]
  2 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 9, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 13, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  3 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 6]
  8 =&gt; [3, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 2, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 14]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 3, 4]
  1 =&gt; [1, 7, 13, 3, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 5, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 13, 10, 2, 4]
  1 =&gt; [1, 7, 14, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 3, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  2 =&gt; [1, 7, 13, 11, 4, 15, 5, 14, 2, 0, 8, 6, 12, 10, 2, 4]
  1 =&gt; [1, 7, 13, 11, 9, 15, 5, 14, 2, 0, 8, 6, 12, 14, 2, 4]
</code></pre>

<p>971 chromosomes sur 1000 sont identiques ! Question diversité génétique
on repassera… Voilà donc comment un extremum local se manifeste dans
un algorithme génétique: toutes les solutions convergent vers un même
point. L&#8217;algorithme ne peut plus produire de nouvelles solutions originales,
il patauge. Les quelques chromosomes différents, 29 sur 1000 dans ce cas là
(ou encore 2,9%) s&#8217;expliquent en grande partie par la mutation.</p>

<p>Si vous étudiez en détail le résultat ci-dessus, vous verrez que chaque
chromosome différent ne diffère du chromosome majoritaire que par un
seul de ses gènes. C&#8217;est la clé pour comprendre pourquoi la mutation
semble impuissante à nous aider dans ce problème des 8 dames, alors que
tout avait bien fonctionné avec le paradoxe du singe savant. On verra
ça dans le prochain article.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/'>Les algorithmes génétiques démystifiés 24</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/26/les-algorithmes-genetiques-demystifies-23/'>Les algorithmes génétiques démystifiés 23</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés: exploration vs exploitation]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/10/01/les-algorithmes-genetiques-demystifies-exploration-vs-exploitation/"/>
    <updated>2013-10-01T14:32:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/10/01/les-algorithmes-genetiques-demystifies-exploration-vs-exploitation</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Pour en finir avec la <em>théorie</em> sur les extremums locaux, je voudrais
aujourd&#8217;hui parler des concepts d&#8217;exploration et d&#8217;exploitation.</p>

<!-- more -->


<h2>Exploration versus exploitation</h2>

<p>Je vais me resservir de quelques petits dessins que j&#8217;ai fait pour l&#8217;article
précédent. Lorsqu&#8217;on lance des sondes au hasard le long de notre fonction,
on est dans une phase d&#8217;exploration:</p>

<p><img src="http://lkdjiin.github.io/images/algo2.jpg"></p>

<p>On <em>explore</em> toute la fonction.</p>

<p>À l&#8217;opposé, quand on se concentre sur une valeur de x et qu&#8217;on compare
<em>f</em>(x) avec <em>f</em>(x + petite valeur) et <em>f</em>(x &ndash; petite valeur), on est
dans une phase d&#8217;exploitation:</p>

<p><img src="http://lkdjiin.github.io/images/algo3.jpg"></p>

<p>On <em>exploite</em> un petit morceau de la fonction. Plus la petite valeur ajoutée
(ou retranchée) à x est petite, plus on exploite la fonction. (<em>Si x peut-être
un nombre entier, ajouter ou soustraire 1 à x est la plus grande exploitation
possible.</em>) Plus cette petite valeur augmente et moins on exploite, plus on
se rapproche d&#8217;une exploration.</p>

<p>Il faut comprendre, et accepter, qu&#8217;à un moment donné, on ne peut pas à la
fois explorer la fonction et l&#8217;exploiter. Il faut choisir entre les deux.
L&#8217;exploration seule ne peut pas nous garantir qu&#8217;on va trouver un
extremum (pas même un extremum local) et l&#8217;exploitation seule risque fort
de trouver un extremum local (et non pas le global).</p>

<p>Pour donner une image &ndash;<em> toutes proportions gardées </em>&ndash; c&#8217;est un peu
comme dans le monde quantique : vous ne pouvez pas mesurer à la fois la
masse et la position d&#8217;une particule, vous devez choisir l&#8217;un ou l&#8217;autre.
Une autre image, plus macroscopique, serait ces jeux vidéos où un brouillard
de guerre masque la carte du monde : vous devez constamment choisir entre
explorer le monde loin de vous et exploiter ce qui est tout près de vous.</p>

<p>Un bon algorithme génétique doit trouver le bon équilibre entre ses deux
possibilités : exploration et exploitation. Et malheureusement pour nous,
ce bon équilibre dépend des chromosomes, il est donc différent pour chaque
problème.</p>

<p>La prochaine fois, fini la théorie, on verra comment un extremum local
se manifeste en pratique dans l&#8217;algorithme génétique du problème des 8 dames.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/30/les-algorithmes-genetiques-demystifies-25-extremum-local/'>Les algorithmes génétiques démystifiés 25: extremum local</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 25: extremum local]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/30/les-algorithmes-genetiques-demystifies-25-extremum-local/"/>
    <updated>2013-09-30T21:41:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/30/les-algorithmes-genetiques-demystifies-25-extremum-local</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Dans cette serie d&#8217;articles sur les algorithmes génétiques, j&#8217;ai
employé le terme <em>extremum local</em> à plusieurs reprises sans jamais
vraiment l&#8217;expliquer.</p>

<!-- more -->


<p>Pour comprendre ce qu&#8217;est un extremum local, on va se servir d&#8217;une
fonction mathématique. Rassurez-vous on ne va pas faire de math, je vais
juste me servir du visuel. Imaginons la fonction <em>f</em>(x) suivante:</p>

<p><img src="http://lkdjiin.github.io/images/algo1.jpg"></p>

<p>Admettons que la fonction <em>f</em> soit notre fonction d&#8217;évaluation. Dans ce
cas chaque x représente un chromosome parmi tous ceux possibles. Et à chaque
valeur x correspond une valeur y qui serait notre score.</p>

<p>Nous voulons connaitre la valeur de x qui maximise la fonction, qui donne
le plus grand y/score possible. Comment faire ? Le plus simple est de
balayer toutes les valeurs possibles de x, soit calculer <em>f</em>(0), <em>f</em>(1),
<em>f</em>(2), etc. Une fois tout ça calculé, on sait quel x donne le plus grand y.
Où est le problème ? Imaginons que x puisse prendre comme valeur les
nombres entiers de zéro à un milliard, imaginons aussi que la fonction
d&#8217;évaluation (<em>f</em>) soit un peu longue et prenne 1 seconde de calcul.
Ça veut dire qu&#8217;il faudra (à la louche) 11820 jours pour balayer
toutes les valeurs de x. Pas possible, faut trouver autre chose.</p>

<p>Les algorithmes génétiques, et plus largement les algorithmes
<em>stochastiques</em>, utilisent en partie le hasard pour résoudre ce
type de problème. La solution la plus simple est d&#8217;évaluer des valeurs
de x tirées au hasard. Plus on disposera de temps, et plus on s&#8217;approchera
<em>théoriquement</em> de la valeur maximum (l&#8217;extremum). La figure suivante
propose cinq valeurs de x au hasard. Un premier hic, c&#8217;est que pour obtenir
l&#8217;extremum en un temps raisonnable, il faut avoir beaucoup de chance.
Un second hic, c&#8217;est que pour être <em>sûr</em> d&#8217;obtenir l&#8217;extremum il faut
toujours balayer toutes les possibilités.</p>

<p><img src="http://lkdjiin.github.io/images/algo2.jpg"></p>

<p>Une solution plus intelligente est de tirer une première valeur de x au
hasard.
Puis on ajoute une petite valeur à x, par exemple 1, 5, 10 ou 100 suivant
l&#8217;étendue des x possibles.
On a donc x1 = x + 1. Si le nouveau y
obtenu est plus grand que l&#8217;ancien on est sur la bonne voie, sinon on
retranche cette petite valeur (x2 = x &ndash; 1). En progressant ainsi par petits
bonds, on arrivera à l&#8217;extremum.</p>

<p><img src="http://lkdjiin.github.io/images/algo3.jpg"></p>

<p>Cette progression par petits bonds est assez proche, dans l&#8217;idée, de la
mecanique des algorithmes génétiques. En ajustant comme il faut la
<em>petite valeur</em> qu&#8217;on ajoute aux x successifs, on obtiendra l&#8217;extremum en
un temps raisonnable.</p>

<p><strong>Edit du 1 oct 2013</strong> Cette petite valeur ajoutée à x peut-être considérée
comme une mutation.</p>

<p>Alors où est le problème maintenant ? Pour le visualiser il faut changer
de fonction mathématique:</p>

<p><img src="http://lkdjiin.github.io/images/algo4.jpg"></p>

<p>Si on n&#8217;a pas de chance, on va tirer au hasard une première valeur de x
qui nous emmènera immanquablement vers un extremum <em>local</em>, et non
pas vers l&#8217;extremum <em>global</em> !</p>

<p>Voilà, j&#8217;espère que cette petite démonstration a remplie son office et
que vous visualisez maintenant clairement cette histoire
d&#8217;extremum local.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/01/les-algorithmes-genetiques-demystifies-exploration-vs-exploitation/'>Les algorithmes génétiques démystifiés: exploration vs exploitation</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby: Les méthodes du module Kernel 3]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/29/ruby-les-methodes-du-module-kernel-3/"/>
    <updated>2013-09-29T12:51:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/29/ruby-les-methodes-du-module-kernel-3</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-1'>Niveau : <span>facile</span></div>


<p>Aujourd&#8217;hui c&#8217;est dimanche, l&#8217;article sera court, on voit deux méthodes
utiles pour le débugage ou pour les fichiers
de log: <code>__method__</code> et <code>__dir__</code>.</p>

<!-- more -->


<h2><code>__method__</code></h2>

<p><code>__method__</code> renvoit le nom de la méthode courante comme un type Symbol:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="n">__method__</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class='line'><span class="go">nil</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="n">foo</span>
</span><span class='line'><span class="go">:foo</span>
</span></code></pre></td></tr></table></div></figure>


<p>Et si vous avez besoin de récupérer une chaîne de caractère:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">bar</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="n">__method__</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class='line'><span class="go">nil</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="n">bar</span>
</span><span class='line'><span class="go">&quot;bar&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h2><code>__dir__</code></h2>

<p>Comme son nom l&#8217;indique presque, cette méthode renvoit le nom (complet)
du répértoire du fichier dans lequel la méthode est appelée:</p>

<figure class='code'><figcaption><span>~/test/dir.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">this_dir</span>
</span><span class='line'>  <span class="n">__dir__</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">this_dir</span>
</span></code></pre></td></tr></table></div></figure>


<pre><code>[~/test]⇒ rvm use 2.0.0
Using /home/xavier/.rvm/gems/ruby-2.0.0-p247
[~/test]⇒ ruby dir.rb 
/home/xavier/test
</code></pre>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/28/ruby-les-methodes-du-module-kernel-2/'>Ruby: Les méthodes du module Kernel 2</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/21/ruby-les-methodes-du-module-kernel/'>Ruby: Les méthodes du module Kernel</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash/'>Ruby: un exemple de valeur par défaut pour un Hash</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby: Les méthodes du module Kernel 2]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/28/ruby-les-methodes-du-module-kernel-2/"/>
    <updated>2013-09-28T13:59:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/28/ruby-les-methodes-du-module-kernel-2</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-1'>Niveau : <span>facile</span></div>


<p>On continue l&#8217;exploration du module Kernel avec quatre
autres méthodes de conversions, pour les nombres:</p>

<ul>
<li>Complex</li>
<li>Float</li>
<li>Integer</li>
<li>Rational</li>
</ul>


<!-- more -->


<p>Voyons d&#8217;abord <code>Integer</code>. On peut lui passer une chaîne de caractère:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Integer</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">123</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ça fonctionne avec les préfixes. En octal, hexadécimal et binaire:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Integer</span><span class="p">(</span><span class="s2">&quot;0123&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">83</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Integer</span><span class="p">(</span><span class="s2">&quot;0x123&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">291</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Integer</span><span class="p">(</span><span class="s2">&quot;0b111&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">7</span>
</span></code></pre></td></tr></table></div></figure>


<p>On peut aussi spécifier la base:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Integer</span><span class="p">(</span><span class="s2">&quot;0123&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span class='line'><span class="go">123</span>
</span></code></pre></td></tr></table></div></figure>


<p>On peut aussi passer en argument un objet répondant à <code>to_int</code> ou <code>to_i</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>  <span class="k">def</span> <span class="nf">to_i</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>    <span class="mi">123</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>  <span class="k">end</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class='line'><span class="go">nil</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Integer</span><span class="p">(</span><span class="no">Foo</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
</span><span class='line'><span class="go">123</span>
</span></code></pre></td></tr></table></div></figure>


<p>Passons maintenant à <code>Float(arg)</code> qui convertit un argument en type <code>Float</code>.
Soit l&#8217;argument est de type <code>Numeric</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Float</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
</span><span class='line'><span class="go">123.0</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Float</span><span class="p">(</span><span class="no">Rational</span><span class="p">(</span><span class="s2">&quot;1/2&quot;</span><span class="p">))</span>
</span><span class='line'><span class="go">0.5</span>
</span></code></pre></td></tr></table></div></figure>


<p>Soit la méthode fait appel à <code>to_f</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>  <span class="k">def</span> <span class="nf">to_f</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>    <span class="mi">1</span><span class="o">.</span><span class="mi">23</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>  <span class="k">end</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class='line'><span class="go">nil</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">Float</span><span class="p">(</span><span class="no">Foo</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
</span><span class='line'><span class="go">1.23</span>
</span></code></pre></td></tr></table></div></figure>


<p>Au tour de la méthode <code>Rational</code> qui convertit son (ses) argument(s) en un
nombre rationnel (de classe <code>Rational</code>), autrement dit une fraction:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="no">Rational</span><span class="p">(</span><span class="s2">&quot;1/3&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">1/3</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="no">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span class='line'><span class="go">1/3</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="no">Rational</span><span class="p">(</span><span class="s2">&quot;1/3&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">1/3</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span>
</span><span class='line'><span class="go">2/3</span>
</span></code></pre></td></tr></table></div></figure>


<p>Reste la méthode <code>Complex</code>, qui convertit son (ses) argument(s) en un nombre
complexe. Je la signale pour être exhaustif, mais les nombres complexes
dépassent largement mes compétences en mathématique.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/29/ruby-les-methodes-du-module-kernel-3/'>Ruby: Les méthodes du module Kernel 3</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/21/ruby-les-methodes-du-module-kernel/'>Ruby: Les méthodes du module Kernel</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash/'>Ruby: un exemple de valeur par défaut pour un Hash</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 24]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/"/>
    <updated>2013-09-27T18:26:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Maintenant vous connaissez bien la procédure : on trouve comment représenter
les chromosomes, comment les évaluer, puis une fois la population
initialisée on sélectionne, on croise, on mute…</p>

<!-- more -->


<p>Dernièrement on s&#8217;est occupé des chromosomes, de l&#8217;évaluation et de la
population. Reste à sélectionner, croiser, muter.
Je ne vais pas trop m&#8217;étendre sur le code permettant de faire ceci puisqu&#8217;il
s&#8217;agit pratiquement d&#8217;un copier/coller des classes développées
précédement. Voici le code permettant de résoudre le problème des
8 dames:</p>

<figure class='code'><figcaption><span>8_queens.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Individual</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="kp">nil</span><span class="p">,</span> <span class="n">chromosome_size</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_chromosome</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">display</span>
</span><span class='line'>    <span class="vi">@chromosome</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">queen_position</span><span class="o">|</span>
</span><span class='line'>      <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>      <span class="vi">@chromosome</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">cell</span><span class="o">|</span>
</span><span class='line'>        <span class="n">row</span> <span class="o">+=</span> <span class="p">(</span><span class="n">cell</span> <span class="o">==</span> <span class="n">queen_position</span><span class="p">)</span> <span class="p">?</span> <span class="s2">&quot;Q&quot;</span> <span class="p">:</span> <span class="s2">&quot;.&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="n">row</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:score</span><span class="p">,</span> <span class="ss">:fitness</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:chromosome</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">chromosome_size</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">chromosome</span>
</span><span class='line'>      <span class="vi">@chromosome</span> <span class="o">=</span> <span class="n">chromosome</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@chromosome</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>      <span class="n">chromosome_size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="vi">@chromosome</span> <span class="o">&lt;&lt;</span> <span class="no">Gene</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="nb">private_class_method</span> <span class="ss">:new</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Gene</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">random</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">rand</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Population</span> <span class="o">&lt;</span> <span class="nb">Array</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">population_size</span><span class="p">)</span>
</span><span class='line'>    <span class="n">population_size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="nb">self</span> <span class="o">&lt;&lt;</span> <span class="no">Individual</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">best</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span><span class="p">}</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Evaluator</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">population</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@board_size</span> <span class="o">=</span> <span class="n">board_size</span>
</span><span class='line'>    <span class="vi">@population</span> <span class="o">=</span> <span class="n">population</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">evaluate</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="n">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">fitness</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="n">board</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">chromosome</span>
</span><span class='line'>    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="vi">@board_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">row1</span><span class="o">|</span>
</span><span class='line'>      <span class="n">gene1</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">row1</span><span class="o">]</span>
</span><span class='line'>      <span class="p">(</span><span class="n">row1</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="vi">@board_size</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row2</span><span class="o">|</span>
</span><span class='line'>        <span class="n">gene2</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">row2</span><span class="o">]</span>
</span><span class='line'>        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">gene1</span> <span class="o">==</span> <span class="n">gene2</span>
</span><span class='line'>        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row2</span> <span class="o">-</span> <span class="n">row1</span> <span class="o">==</span> <span class="p">(</span><span class="n">gene1</span> <span class="o">-</span> <span class="n">gene2</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">score</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">fitness</span>
</span><span class='line'>    <span class="n">total</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">individual</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="p">}</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">individual</span><span class="o">|</span>
</span><span class='line'>      <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">to_f</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="vi">@population</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">GeneticAlgorithm</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@generations</span> <span class="o">=</span> <span class="n">generations</span>
</span><span class='line'>    <span class="vi">@population</span> <span class="o">=</span> <span class="n">population</span>
</span><span class='line'>    <span class="vi">@board_size</span> <span class="o">=</span> <span class="n">board_size</span>
</span><span class='line'>    <span class="vi">@mutation_rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
</span><span class='line'>    <span class="vi">@crossover</span> <span class="o">=</span> <span class="no">Crossover</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">run</span>
</span><span class='line'>    <span class="vi">@generations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">generation</span><span class="o">|</span>
</span><span class='line'>      <span class="no">Evaluator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@board_size</span><span class="p">,</span> <span class="vi">@population</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span>
</span><span class='line'>      <span class="n">best</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">best</span>
</span><span class='line'>      <span class="nb">display</span><span class="p">(</span><span class="n">generation</span><span class="p">,</span> <span class="n">best</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">best</span><span class="o">.</span><span class="n">score</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'>        <span class="n">best</span><span class="o">.</span><span class="n">display</span>
</span><span class='line'>        <span class="nb">exit</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">next_generation</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">generation</span><span class="p">,</span> <span class="n">best</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;----------------------&quot;</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Gen: </span><span class="si">#{</span><span class="n">generation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Best: </span><span class="si">#{</span><span class="n">best</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">next_generation</span>
</span><span class='line'>    <span class="n">pool</span> <span class="o">=</span> <span class="no">MatingPool</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@population</span><span class="p">)</span>
</span><span class='line'>    <span class="n">population_size</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">clear</span>
</span><span class='line'>    <span class="n">population_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@population</span> <span class="o">&lt;&lt;</span> <span class="vi">@crossover</span><span class="o">.</span><span class="n">two_point</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="n">pool</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MatingPool</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@mating_pool</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">population</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">individual</span><span class="o">|</span>
</span><span class='line'>      <span class="n">integer_part</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'>      <span class="n">real_part</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span> <span class="o">-</span> <span class="n">integer_part</span>
</span><span class='line'>      <span class="n">integer_part</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="vi">@mating_pool</span> <span class="o">&lt;&lt;</span> <span class="n">individual</span><span class="o">.</span><span class="n">dup</span> <span class="p">}</span>
</span><span class='line'>      <span class="vi">@mating_pool</span> <span class="o">&lt;&lt;</span> <span class="n">individual</span><span class="o">.</span><span class="n">dup</span> <span class="k">if</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="n">real_part</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="vi">@size</span> <span class="o">=</span> <span class="vi">@mating_pool</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">random</span>
</span><span class='line'>    <span class="vi">@mating_pool</span><span class="o">[</span><span class="nb">rand</span><span class="p">(</span><span class="vi">@size</span><span class="p">)</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Crossover</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@size</span> <span class="o">=</span> <span class="n">chromosome_size</span>
</span><span class='line'>    <span class="vi">@rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
</span><span class='line'>    <span class="vi">@mutator</span> <span class="o">=</span> <span class="no">Mutator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@size</span><span class="p">,</span> <span class="vi">@rate</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">two_point</span><span class="p">(</span><span class="n">parent1</span><span class="p">,</span> <span class="n">parent2</span><span class="p">)</span>
</span><span class='line'>    <span class="n">child</span> <span class="o">=</span> <span class="n">assemble</span><span class="p">(</span><span class="n">parent1</span><span class="p">,</span> <span class="n">parent2</span><span class="p">,</span> <span class="n">two_cut_points</span><span class="p">)</span>
</span><span class='line'>    <span class="n">child</span> <span class="o">=</span> <span class="vi">@mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span class='line'>    <span class="no">Individual</span><span class="o">.</span><span class="n">from_chromosome</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">two_cut_points</span>
</span><span class='line'>    <span class="n">point1</span> <span class="o">=</span> <span class="n">cut_point</span>
</span><span class='line'>    <span class="n">point2</span> <span class="o">=</span> <span class="n">cut_point</span>
</span><span class='line'>    <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span> <span class="o">=</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point1</span> <span class="k">if</span> <span class="n">point1</span> <span class="o">&gt;</span> <span class="n">point2</span>
</span><span class='line'>    <span class="o">[</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">cut_point</span>
</span><span class='line'>    <span class="nb">rand</span><span class="p">(</span><span class="vi">@size</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">assemble</span><span class="p">(</span><span class="n">parent1</span><span class="p">,</span> <span class="n">parent2</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
</span><span class='line'>    <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span> <span class="o">=</span> <span class="n">points</span>
</span><span class='line'>    <span class="n">parent1</span><span class="o">.</span><span class="n">chromosome</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">point1</span><span class="o">]</span> <span class="o">+</span>
</span><span class='line'>      <span class="n">parent2</span><span class="o">.</span><span class="n">chromosome</span><span class="o">[</span><span class="n">point1</span><span class="o">.</span><span class="n">.point2</span><span class="o">]</span> <span class="o">+</span>
</span><span class='line'>      <span class="n">parent1</span><span class="o">.</span><span class="n">chromosome</span><span class="o">[</span><span class="n">point2</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Mutator</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@size</span> <span class="o">=</span> <span class="n">chromosome_size</span>
</span><span class='line'>    <span class="vi">@rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">index</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="vi">@rate</span>
</span><span class='line'>        <span class="n">chromosome</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="no">Gene</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="vi">@size</span><span class="p">)</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">chromosome</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">generations</span> <span class="o">=</span> <span class="mi">500</span>
</span><span class='line'><span class="n">board_size</span> <span class="o">=</span> <span class="mi">8</span>
</span><span class='line'><span class="n">population</span> <span class="o">=</span> <span class="no">Population</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span class='line'><span class="n">mutation</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="mo">001</span>
</span><span class='line'><span class="no">GeneticAlgorithm</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">mutation</span><span class="p">)</span><span class="o">.</span><span class="n">run</span>
</span></code></pre></td></tr></table></div></figure>


<p>J&#8217;ai seulement ajouter une méthode <code>display</code> à la classe <code>Individual</code> pour
afficher à l&#8217;écran une représentation de la solution. Voilà le programme
en marche:</p>

<pre><code>[~/genetic]⇒ ruby 8_queens.rb 
----------------------
Gen: 0
Best: 0.5
----------------------
Gen: 1
Best: 0.5
.
.
.
Gen: 11
Best: 1.0
----------------------
Gen: 12
Best: Infinity
.......Q
.Q......
...Q....
Q.......
......Q.
....Q...
..Q.....
.....Q..
</code></pre>

<p>Cool ! Une solution en 12 générations. J&#8217;ai écrit récemment que trouver
une solution pour un échiquier de 8 x 8 cases ne serait pas difficile.
Et bien voilà, c&#8217;est fait. J&#8217;ai écrit aussi qu&#8217;il serait plus intéressant de
voir ce qu&#8217;il se passe avec des plateaux plus grands. Si on essaye en
doublant les dimensions:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">board_size</span> <span class="o">=</span> <span class="mi">16</span>
</span></code></pre></td></tr></table></div></figure>


<p>On aura de grandes chances de voir ce type de sortie:</p>

<pre><code>[~/genetic]⇒ ruby 8_queens.rb 
----------------------
Gen: 0
Best: 0.125
----------------------
Gen: 1
Best: 0.16666666666666666
.
.
.
Gen: 70
Best: 0.5
----------------------
Gen: 71
Best: 1.0
.
.
.
----------------------
Gen: 499
Best: 1.0
</code></pre>

<p>Plus de 400 générations coincées sur le même résultat. Vous pensiez en
avoir fini avec les extremums locaux ? Et ben non, ils ne sont jamais
bien loin. 3 questions:</p>

<ol>
<li>Comment je sais que l&#8217;algorithme est coinçé dans un extremum local ?</li>
<li>Pourquoi cet algorithme coinçe alors qu&#8217;il est écrit comme le
précédent qui lui, ne coinçait pas ?</li>
<li>Comment on s&#8217;en sort ?</li>
</ol>


<p>Avant de répondre à cela, je pense qu&#8217;il est plus que temps d&#8217;expliquer
quelques petites choses sur les extremums locaux:</p>

<ol>
<li>Qu&#8217;est ce que c&#8217;est qu&#8217;un extremum local ?</li>
<li>Comment un extremum local se manifeste dans les algorithmes génétiques ?</li>
</ol>


<p>J&#8217;ai mon sujet pour le prochain article…</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/26/les-algorithmes-genetiques-demystifies-23/'>Les algorithmes génétiques démystifiés 23</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 23]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/26/les-algorithmes-genetiques-demystifies-23/"/>
    <updated>2013-09-26T18:19:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/26/les-algorithmes-genetiques-demystifies-23</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Pour évaluer une solution potentielle dans le problème des 8 dames, on va
devoir calculer le nombre de paires de dames qui sont en conflit (en prise,
pour les joueurs d&#8217;échecs).</p>

<!-- more -->


<p>Dans <a href="http://lkdjiin.github.io/blog/2013/09/25/les-algorithmes-genetiques-demystifies-22/">l&#8217;article précédent</a>
on a mis en place la classe <code>Evaluator</code>, mais il manquait une partie
déterminante: le calcul du nombre de conflits. Le voici:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="n">board</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">chromosome</span>
</span><span class='line'>    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="vi">@board_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">row1</span><span class="o">|</span>
</span><span class='line'>      <span class="n">gene1</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">row1</span><span class="o">]</span>
</span><span class='line'>      <span class="p">(</span><span class="n">row1</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="vi">@board_size</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row2</span><span class="o">|</span>
</span><span class='line'>        <span class="n">gene2</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">row2</span><span class="o">]</span>
</span><span class='line'>        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">gene1</span> <span class="o">==</span> <span class="n">gene2</span>
</span><span class='line'>        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row2</span> <span class="o">-</span> <span class="n">row1</span> <span class="o">==</span> <span class="p">(</span><span class="n">gene1</span> <span class="o">-</span> <span class="n">gene2</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">score</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Je ne suis pas très satisfait de cette méthode, elle est assez imposante
(trop longue) et difficile à lire (pas claire). Néanmoins elle fait son
travail et c&#8217;est ce qui compte pour l&#8217;instant. Je ferais peut-être du
refactoring plus tard (ou bien c&#8217;est un lecteur charitable qui va nous
le faire ?). Une explication s&#8217;impose:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@board_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">row1</span><span class="o">|</span>
</span><span class='line'>  <span class="n">gene1</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">row1</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>On a une première itération sur chaque rangées. Dans chaque boucle, la variable
<code>gene1</code> reçoit la position de la dame de cette rangée, c&#8217;est à dire
le numéro de la colonne (base 0). On va ensuite
comparer cette dame avec les dames des rangées suivantes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="p">(</span><span class="n">row1</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="vi">@board_size</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row2</span><span class="o">|</span>
</span><span class='line'>    <span class="n">gene2</span> <span class="o">=</span> <span class="n">board</span><span class="o">[</span><span class="n">row2</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Dans cette seconde itération, <code>gene2</code> reçoit successivement les positions
de chaque dames restantes. On peut maintenant regarder si deux dames sont
dans la même colonne:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>    <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">gene1</span> <span class="o">==</span> <span class="n">gene2</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ça se passe de commentaire… Pour savoir si deux dames sont sur une
même diagonale, c&#8217;est un peu plus tordu:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>    <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row2</span> <span class="o">-</span> <span class="n">row1</span> <span class="o">==</span> <span class="p">(</span><span class="n">gene1</span> <span class="o">-</span> <span class="n">gene2</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span></code></pre></td></tr></table></div></figure>


<p>Je vois un peu ça comme un problème de géométrie. Si deux dames ont le
même écart en nombre de colonnes et en nombre de rangées, c&#8217;est qu&#8217;elles
partagent la même diagonale.</p>

<p>Cet article n&#8217;était pas vraiment orienté algorithme génétique mais je pense
qu&#8217;il était pourtant nécessaire. Si on a pas une bonne fonction d&#8217;évaluation,
un algorithme génétique n&#8217;est d&#8217;aucune aide. C&#8217;est pour ça que la première
chose que je fais quand j&#8217;aborde un nouveau problème c&#8217;est de réfléchir au
combo évaluation/chromosome jusqu&#8217;à en avoir une vision claire.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/'>Les algorithmes génétiques démystifiés 24</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 22]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/25/les-algorithmes-genetiques-demystifies-22/"/>
    <updated>2013-09-25T14:22:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/25/les-algorithmes-genetiques-demystifies-22</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Après avoir trouver comment représenter un chromosome pour le
problème des 8 dames (<a href="http://lkdjiin.github.io/blog/2013/09/24/les-algorithmes-genetiques-demystifies-21-probleme-des-8-dames/">article précédent</a>),
on regarde aujourd&#8217;hui comment réaliser l&#8217;évaluation de la population.</p>

<!-- more -->


<p>Sans plus attendre, voici la classe <code>Evaluator</code> dans toute sa
splendeur, on la détaille après:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Evaluator</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">population</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@board_size</span> <span class="o">=</span> <span class="n">board_size</span>
</span><span class='line'>    <span class="vi">@population</span> <span class="o">=</span> <span class="n">population</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">evaluate</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="n">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">fitness</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="c1"># Calcule et renvoie le nombre de paires de dames en conflits.</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">fitness</span>
</span><span class='line'>    <span class="n">total</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">individual</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="p">}</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">individual</span><span class="o">|</span>
</span><span class='line'>      <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">to_f</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="vi">@population</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Tout d&#8217;abord le constucteur:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">population</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Il prends comme paramêtre la taille de l&#8217;échiquier et la population à
évaluer. Trouver une solution pour un échiquier de 8 x 8 cases ne
devrait pas être trop difficile et il sera plus intéressant de voir
comment l&#8217;algorithme se débrouille avec des échiquiers de plus grande
taille.</p>

<p>La méthode <code>evalute</code> est identique à celle de la
<a href="http://lkdjiin.github.io/blog/2013/09/19/les-algorithmes-genetiques-demystifies-18/">dernière fois</a>:
elle calcule le <em>score</em> puis le <em>fitness</em> de chaque individu.</p>

<p>Passons à la méthode <code>conflicts</code>, qui n&#8217;est pas encore implémentée:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="c1"># Calcule et renvoie le nombre de paires de dames en conflits.</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>C&#8217;est en calculant le nombre de paires de dames en conflits qu&#8217;on pourra
évaluer les différentes positions. Plus il y a de conflits, plus on est
loin d&#8217;une solution. À l&#8217;inverse, une solution possède zéro conflits.
L&#8217;implémentation sera pour la prochaine fois.</p>

<p>Voyons maintenant la méthode <code>score</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">conflicts</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pourquoi diviser 1 par le nombre de conflits ? Pourquoi ne pas avoir écrit
simplement <code>individual.score = conflicts(individual)</code> ?
Parce que je ne trouve pas naturel qu&#8217;un score de zéro soit meilleur qu&#8217;un
score de 5, 10, 20, etc. Je préfère donc calculer l&#8217;inverse du nombre de
conflits. De cette manière si il y a 10 conflits, le score sera 0,1 et si il
y a 2 conflits le score sera 0,5. Et si il y a zéro conflits ? Ruby ne pose
pas de problème avec les nombres réèls:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="go">[~]⇒ irb</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span>
</span><span class='line'><span class="go">Infinity</span>
</span></code></pre></td></tr></table></div></figure>


<p>Je saurais donc que j&#8217;ai trouvé une solution quand un score sera supérieur
à 1. Avec d&#8217;autres langages on peut gérer ça avec des exceptions, des erreurs,
détecter la division par zéro avant de la faire, etc. Ou encore ajouter
une petite valeur au nombre de conflits, par exemple:</p>

<pre><code>score = 1.0 / (nombre_de_conflits + 0.1)
</code></pre>

<p>La prochaine fois on verra comment calculer le nombre de conflits.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/'>Les algorithmes génétiques démystifiés 24</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 21: Problème des 8 dames]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/24/les-algorithmes-genetiques-demystifies-21-probleme-des-8-dames/"/>
    <updated>2013-09-24T10:04:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/24/les-algorithmes-genetiques-demystifies-21-probleme-des-8-dames</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>On va tenter de résoudre le problème des 8 dames à l&#8217;aide d&#8217;un algorithme
génétique.</p>

<blockquote><p>Le but du problème des huit dames est de placer huit dames d&#8217;un jeu d&#8217;échecs sur un échiquier de 8 × 8 cases sans que les dames ne puissent se menacer mutuellement, conformément aux règles du jeu d&#8217;échecs (la couleur des pièces étant ignorée). Par conséquent, deux dames ne devraient jamais partager la même rangée, colonne, ou diagonale.</p><footer><strong>Wikipédia</strong> <cite><a href='http://fr.wikipedia.org/wiki/Probl%C3%A8me_des_huit_dames'>fr.wikipedia.org/wiki/&hellip;</a></cite></footer></blockquote>




<!-- more -->


<p>Avant toute chose, il faut trouver comment nos chromosomes vont pouvoir
représenter une solution potentielle. On pourrait coder ça sous forme
d&#8217;une chaîne de 64 bits, un par case, les 0 étants des cases vides et
les 1 étants les cases occupées par les dames. On pourrait aussi les coder
comme un tableau à deux dimensions, soit 8 rangées multipliées par 8 colonnes.
En y regardant de plus près (ou simplement en relisant la définition du
problème), on remarque que pour qu&#8217;une solution soit
viable, il faut une seule dame par rangée, une seule par colonne et une
seule par diagonale. On peut donc se contenter d&#8217;une liste (un tableau) de
8 nombres entiers, ces nombres étants le numéro de la colonne. Ainsi, pour
un échiquier de 4 x 4 cases, la liste <code>[0, 2, 3, 3]</code> équivaut à la position
suivante:</p>

<pre><code>---------
|D| | | |
---------
| | |D| |
---------
| | | |D|
---------
| | | |D|
---------
</code></pre>

<p>Maintenant on peut s&#8217;occuper de la population. Je vais me servir du code
objet développé dans les derniers articles, en essayant de le modifier
le moins possible.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Individual</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="kp">nil</span><span class="p">,</span> <span class="n">chromosome_size</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_chromosome</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:score</span><span class="p">,</span> <span class="ss">:fitness</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:chromosome</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">chromosome_size</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">chromosome</span>
</span><span class='line'>      <span class="vi">@chromosome</span> <span class="o">=</span> <span class="n">chromosome</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@chromosome</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>      <span class="n">chromosome_size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="vi">@chromosome</span> <span class="o">&lt;&lt;</span> <span class="no">Gene</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="nb">private_class_method</span> <span class="ss">:new</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Gene</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">random</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">rand</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Population</span> <span class="o">&lt;</span> <span class="nb">Array</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">population_size</span><span class="p">)</span>
</span><span class='line'>    <span class="n">population_size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="nb">self</span> <span class="o">&lt;&lt;</span> <span class="no">Individual</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">best</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span><span class="p">}</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>J&#8217;ai été obligé de modifier la méthode <code>initialize</code> de la classe <code>Individual</code>
ainsi que la classe <code>Gene</code>. Il faudra en tenir compte si on veut qu&#8217;un
framework sorte de tout ça…</p>

<p>Le prochain article traitera de l&#8217;évaluation du problème des 8 dames.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/'>Les algorithmes génétiques démystifiés 24</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 20]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/23/les-algorithmes-genetiques-demystifies-20/"/>
    <updated>2013-09-23T18:41:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/23/les-algorithmes-genetiques-demystifies-20</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>C&#8217;est le vingtième article de cette série sur les algorithmes génétiques et
j&#8217;aimerai en profiter pour dresser un petit bilan provisoire.</p>

<!-- more -->


<p>On a vu le fonctionnement d&#8217;un algorithme génétique à l&#8217;aide de deux exemples
simples. Dans le premier exemple il s&#8217;agissait de trouver une expression comme
«123+54x3» et dans le second il fallait trouver la chaîne «Mon royaume pour un
cheval».</p>

<p>On a appris à représenter une population d&#8217;individus. Chaque individu étant une
solution potentielle du problême posé. Cette solution est codée dans le
chromosome d&#8217;un individu. On a vu l&#8217;utilisation «historique» d&#8217;une chaîne de
bits pour réprésenter les chromosomes, mais aussi qu&#8217;on pouvait utiliser une
chaîne de caractères quelconques. En fait, il ne faut pas hésiter à représenter
les chromosomes comme bon vous semble.</p>

<p>On a vu ensuite la phase d&#8217;évaluation de la population. Il s&#8217;agit d&#8217;abord
d&#8217;évaluer un chromosome seul en lui affectant un score, puis de l&#8217;évaluer par
rapport aux autres chromosomes, en lui affectant un <em>fitness</em> (aptitude).  Le
fitness permettant d&#8217;être plus fin lors de l&#8217;étape de sélection.</p>

<p>Pour l&#8217;étape de la sélection, nous avons vu deux manières de faire :
l&#8217;élitisme et la roue de la fortune. L&#8217;élitisme consiste à ne conserver
qu&#8217;un pourcentage des meilleurs spécimens d&#8217;une génération. La roue de la
fortune consiste à donner à chaque individu une chance plus ou moins
grande de se reproduire en rapport avec son <em>fitness</em>.</p>

<p>Nous avons fait se reproduire les individus/solutions selectionnés par
croisement de leurs chromosomes. À partir de deux parents, nous avons
obtenu un ou deux enfants. On a utilisé la méthode du croisement en
un point, du croisement en deux points et du croisement uniforme.</p>

<p>Enfin, la mutation (ou l&#8217;apport de matériel génétique inédit d&#8217;une façon ou d&#8217;une
autre) a joué un rôle déterminant pour éviter à nos algorithmes de tomber dans
un extremum local.</p>

<p>En résumé, on a abordé pas mal de choses. Mais ce n&#8217;est que la surface
de l&#8217;iceberg.</p>

<p>Pour les articles à venir, je pense me pencher sur le
<a href="http://fr.wikipedia.org/wiki/Probl%C3%A8me_des_huit_dames">problème des 8 dames</a>.
Ça permettra de voir une autre façon de coder un chromosome et aussi de
confronter les classes développées dans les derniers articles à un
problème bien différent. Ensuite, j&#8217;aimerais résoudre un problème visuel.
Du genre : «Si je dispose de 1000 carrés de taille et de couleur quelconque,
quelle est la meilleure disposition pour s&#8217;approcher au mieux d&#8217;une
image donnée ?». C&#8217;est typiquement le genre de problème qui pourrait
tourner dans les navigateurs et être codé en Javascript. Avez-vous
d&#8217;autres idées/envies pour la suite ?</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/10/04/les-algorithmes-genetiques-demystifies-28/'>Les algorithmes génétiques démystifiés 28</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/02/les-algorithmes-genetiques-demystifies-27/'>Les algorithmes génétiques démystifiés 27</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/27/les-algorithmes-genetiques-demystifies-24/'>Les algorithmes génétiques démystifiés 24</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dans le grenier: Le premier pas vers l'an 2000]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/22/dans-le-grenier-le-premier-pas-vers-lan-2000/"/>
    <updated>2013-09-22T21:51:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/22/dans-le-grenier-le-premier-pas-vers-lan-2000</id>
    <content type="html"><![CDATA[<p>En fouillant dans le grenier, j&#8217;ai retrouvé un livre de 1989 au titre
évocateur : «Devenir champion de Logo plus».</p>

<p><img src="http://lkdjiin.github.io/images/livre_logo.jpg"></p>

<!-- more -->


<p>C&#8217;est une phrase sur la quatrième de couverture qui m&#8217;a le plus frappé:
«En route vers l&#8217;an 2000». Assez drôle avec le recul, mais à l&#8217;époque on
voyait ça partout.</p>

<p>Mon souvenir du langage Logo est assez nostalgique. J&#8217;ai beaucoup
apprécié de l&#8217;utiliser. 25 ans plus tard, je me demande si je
l&#8217;apprécierai toujours autant ? Je pense que je vais consacrer quelques
articles à ce langage, histoire de me remémorer ses particularités.</p>

<p>À demain.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby: Les méthodes du module Kernel]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/21/ruby-les-methodes-du-module-kernel/"/>
    <updated>2013-09-21T13:53:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/21/ruby-les-methodes-du-module-kernel</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-1'>Niveau : <span>facile</span></div>


<p>Les méthodes définies dans le module Kernel de Ruby sont <em>à priori</em> des
méthodes très importantes. En effet le module Kernel est inclus d&#8217;office
dans la classe Object, et donc, ses méthodes sont toujours disponibles.
Elles s&#8217;utilisent directement sous la forme <code>method_name</code> et non pas
<code>object_name.method_name</code>. C&#8217;est cette différence de traitement qui
me donne à penser qu&#8217;elles sont importantes. Dans cette série d&#8217;articles,
je me propose de passer en revue chacune des méthodes du module Kernel
de Ruby version 2.0.</p>

<!-- more -->


<p>Aujourd&#8217;hui on voit les méthodes suivantes:</p>

<ul>
<li>Array(<em>arg</em>)</li>
<li>Hash(<em>arg</em>)</li>
<li>String(<em>arg</em>)</li>
</ul>


<p>Ce sont toutes les trois des méthodes de conversions. Elles transforment
respectivement l&#8217;argument en un type Array, Hash ou String. Pour effectuer
cette conversion elles utilisent la méthode <code>to_*</code> sur l&#8217;argument. Par
exemple <code>String(self)</code> utilise <code>self.to_s</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="go">[~]⇒ irb</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">String</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
</span><span class='line'><span class="go">&quot;main&quot;</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="nb">self</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="go">&quot;main</span>
</span></code></pre></td></tr></table></div></figure>


<p>La particularité de ces méthodes est que leur nom débutent par une majuscule,
ce qui va à l&#8217;encontre des conventions en Ruby et les fait ressembler un
peu comme à un constructeur en Java et consorts. D&#8217;un autre coté, le langage
n&#8217;empêche pas de nommer les méthodes ainsi:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='irb'><span class='line'><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">Foo</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span class='line'><span class="gp">&gt;&gt; </span>  <span class="nb">puts</span> <span class="n">arg</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="k">end</span>
</span><span class='line'><span class="go">nil</span>
</span><span class='line'><span class="gp">&gt;&gt; </span><span class="no">Foo</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
</span><span class='line'><span class="go">hello</span>
</span><span class='line'><span class="go">nil</span>
</span></code></pre></td></tr></table></div></figure>


<p>J&#8217;imagine que si ces méthodes débutent par une majuscule, c&#8217;est pour
permettre aux développeurs d&#8217;utiliser <code>array</code>, <code>hash</code> et <code>string</code> comme
nom de variable. Par contre je n&#8217;arrive pas à trouver une utilité à
ces méthodes… Je veux dire pourquoi utiliser <code>String(arg)</code> plutôt que
<code>arg.to_s</code> ?</p>

<p>Si toi, Lecteur, tu as une réponse, n&#8217;hésite pas à laisser un commentaire ;&ndash;)</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/29/ruby-les-methodes-du-module-kernel-3/'>Ruby: Les méthodes du module Kernel 3</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/28/ruby-les-methodes-du-module-kernel-2/'>Ruby: Les méthodes du module Kernel 2</a></li><li><a href='http://lkdjiin.github.io/blog/2013/10/03/ruby-un-exemple-de-valeur-par-defaut-pour-un-hash/'>Ruby: un exemple de valeur par défaut pour un Hash</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 19]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/20/les-algorithmes-genetiques-demystifies-19/"/>
    <updated>2013-09-20T09:31:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/20/les-algorithmes-genetiques-demystifies-19</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Suite et fin de la transformation en code orienté objet de l&#8217;algorithme
génétique sur le paradoxe du singe savant.</p>

<!-- more -->


<p>Le rôle de la classe <code>MatingPool</code> est de sélectionner les individus pour
la reproduction, suivant la méthode de la roue de la fortune:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">MatingPool</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@mating_pool</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">population</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">individual</span><span class="o">|</span>
</span><span class='line'>      <span class="n">integer_part</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'>      <span class="n">real_part</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span> <span class="o">-</span> <span class="n">integer_part</span>
</span><span class='line'>      <span class="n">integer_part</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="vi">@mating_pool</span> <span class="o">&lt;&lt;</span> <span class="n">individual</span><span class="o">.</span><span class="n">dup</span> <span class="p">}</span>
</span><span class='line'>      <span class="vi">@mating_pool</span> <span class="o">&lt;&lt;</span> <span class="n">individual</span><span class="o">.</span><span class="n">dup</span> <span class="k">if</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="n">real_part</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="vi">@size</span> <span class="o">=</span> <span class="vi">@mating_pool</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">random</span>
</span><span class='line'>    <span class="vi">@mating_pool</span><span class="o">[</span><span class="nb">rand</span><span class="p">(</span><span class="vi">@size</span><span class="p">)</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Au passage, la méthode <code>random</code> permettra de choisir un parent au hasard.</p>

<p>Les classes <code>Crossover</code> et <code>Mutator</code> s&#8217;occupent bien sûr de la partie
reproduction:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Crossover</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@size</span> <span class="o">=</span> <span class="n">chromosome_size</span>
</span><span class='line'>    <span class="vi">@rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
</span><span class='line'>    <span class="vi">@mutator</span> <span class="o">=</span> <span class="no">Mutator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@size</span><span class="p">,</span> <span class="vi">@rate</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">two_point</span><span class="p">(</span><span class="n">parent1</span><span class="p">,</span> <span class="n">parent2</span><span class="p">)</span>
</span><span class='line'>    <span class="n">child</span> <span class="o">=</span> <span class="n">assemble</span><span class="p">(</span><span class="n">parent1</span><span class="p">,</span> <span class="n">parent2</span><span class="p">,</span> <span class="n">two_cut_points</span><span class="p">)</span>
</span><span class='line'>    <span class="n">child</span> <span class="o">=</span> <span class="vi">@mutator</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span class='line'>    <span class="no">Individual</span><span class="o">.</span><span class="n">from_chromosome</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">two_cut_points</span>
</span><span class='line'>    <span class="n">point1</span> <span class="o">=</span> <span class="n">cut_point</span>
</span><span class='line'>    <span class="n">point2</span> <span class="o">=</span> <span class="n">cut_point</span>
</span><span class='line'>    <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span> <span class="o">=</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point1</span> <span class="k">if</span> <span class="n">point1</span> <span class="o">&gt;</span> <span class="n">point2</span>
</span><span class='line'>    <span class="o">[</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">cut_point</span>
</span><span class='line'>    <span class="nb">rand</span><span class="p">(</span><span class="vi">@size</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">assemble</span><span class="p">(</span><span class="n">parent1</span><span class="p">,</span> <span class="n">parent2</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
</span><span class='line'>    <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span> <span class="o">=</span> <span class="n">points</span>
</span><span class='line'>    <span class="n">parent1</span><span class="o">.</span><span class="n">chromosome</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">point1</span><span class="o">]</span> <span class="o">+</span> <span class="n">parent2</span><span class="o">.</span><span class="n">chromosome</span><span class="o">[</span><span class="n">point1</span><span class="o">.</span><span class="n">.point2</span><span class="o">]</span> <span class="o">+</span>
</span><span class='line'>      <span class="n">parent1</span><span class="o">.</span><span class="n">chromosome</span><span class="o">[</span><span class="n">point2</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Mutator</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@size</span> <span class="o">=</span> <span class="n">chromosome_size</span>
</span><span class='line'>    <span class="vi">@rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span><span class="o">|</span><span class="n">index</span><span class="o">|</span> <span class="n">chromosome</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="no">Gene</span><span class="o">.</span><span class="n">random</span> <span class="k">if</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="vi">@rate</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">chromosome</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Le code de ces trois classes reprends plus ou moins le code développé en
style procédural dans les articles précédents et je ne vois pas tellement
ce que je pourrais en dire de plus. Il reste donc à lancer la machine:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">generations</span> <span class="o">=</span> <span class="mi">500</span>
</span><span class='line'><span class="n">search</span> <span class="o">=</span> <span class="s2">&quot;Mon royaume pour un cheval&quot;</span>
</span><span class='line'><span class="n">population</span> <span class="o">=</span> <span class="no">Population</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span class='line'><span class="n">mutation</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="mo">001</span>
</span><span class='line'><span class="no">GeneticAlgorithm</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">search</span><span class="p">,</span> <span class="n">mutation</span><span class="p">)</span><span class="o">.</span><span class="n">run</span>
</span></code></pre></td></tr></table></div></figure>


<p>Voilà, c&#8217;est terminé pour le code objet. Quand j&#8217;aurais présenter 2 ou 3
algorithmes génétiques de plus, on verra quelles classes résistent et peuvent
être réutilisées et lesquelles doivent être repensées. Ça nous conduira
éventuellement vers la création d&#8217;un framework…</p>

<p>À demain</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/19/les-algorithmes-genetiques-demystifies-18/'>Les algorithmes génétiques démystifiés 18</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/18/les-algorithmes-genetiques-demystifies-17-oriente-objet/'>Les algorithmes génétiques démystifiés 17: Orienté Objet</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/17/les-algorithmes-genetiques-demystifies-16-le-hill-climbing/'>Les algorithmes génétiques démystifiés 16: Le Hill-Climbing</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 18]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/19/les-algorithmes-genetiques-demystifies-18/"/>
    <updated>2013-09-19T18:14:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/19/les-algorithmes-genetiques-demystifies-18</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>On continue la transformation en code orienté objet de l&#8217;algorithme génétique
sur le paradoxe du singe savant.</p>

<!-- more -->


<p>D&#8217;abord la classe <code>Evaluator</code>, dont le rôle est d&#8217;évaluer la population:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Evaluator</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">search_value</span><span class="p">,</span> <span class="n">population</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@search_value</span> <span class="o">=</span> <span class="n">search_value</span>
</span><span class='line'>    <span class="vi">@population</span> <span class="o">=</span> <span class="n">population</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">evaluate</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="n">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">fitness</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
</span><span class='line'>    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>    <span class="n">individual</span><span class="o">.</span><span class="n">chromosome</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">character</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span><span class='line'>      <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="vi">@search_value</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">==</span> <span class="n">character</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">score</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">fitness</span>
</span><span class='line'>    <span class="n">total</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span> <span class="n">individual</span><span class="o">|</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">size</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">individual</span><span class="o">|</span>
</span><span class='line'>      <span class="n">individual</span><span class="o">.</span><span class="n">fitness</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">to_f</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="n">size</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>On voit le découpage entre <em>score</em> et <em>fitness</em>, dont on a parlé hier.</p>

<p>Ensuite, voici la classe <code>GeneticAlgorithm</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">GeneticAlgorithm</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">search_value</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@generations</span> <span class="o">=</span> <span class="n">generations</span>
</span><span class='line'>    <span class="vi">@population</span> <span class="o">=</span> <span class="n">population</span>
</span><span class='line'>    <span class="vi">@search_value</span> <span class="o">=</span> <span class="n">search_value</span>
</span><span class='line'>    <span class="vi">@mutation_rate</span> <span class="o">=</span> <span class="n">mutation_rate</span>
</span><span class='line'>    <span class="vi">@crossover</span> <span class="o">=</span> <span class="no">Crossover</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">search_value</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">mutation_rate</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">run</span>
</span><span class='line'>    <span class="vi">@generations</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">generation</span><span class="o">|</span>
</span><span class='line'>      <span class="no">Evaluator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@search_value</span><span class="p">,</span> <span class="vi">@population</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span>
</span><span class='line'>      <span class="n">best</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">best</span>
</span><span class='line'>      <span class="nb">display</span><span class="p">(</span><span class="n">generation</span><span class="p">,</span> <span class="n">best</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">exit</span> <span class="k">if</span> <span class="n">best</span><span class="o">.</span><span class="n">score</span> <span class="o">==</span> <span class="vi">@search_value</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>      <span class="n">next_generation</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">generation</span><span class="p">,</span> <span class="n">best</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;----------------------&quot;</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Gen: </span><span class="si">#{</span><span class="n">generation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Best: </span><span class="si">#{</span><span class="n">best</span><span class="o">.</span><span class="n">chromosome</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">next_generation</span>
</span><span class='line'>    <span class="n">pool</span> <span class="o">=</span> <span class="no">MatingPool</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="vi">@population</span><span class="p">)</span>
</span><span class='line'>    <span class="n">population_size</span> <span class="o">=</span> <span class="vi">@population</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>    <span class="vi">@population</span><span class="o">.</span><span class="n">clear</span>
</span><span class='line'>    <span class="n">population_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@population</span> <span class="o">&lt;&lt;</span> <span class="vi">@crossover</span><span class="o">.</span><span class="n">two_point</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">random</span><span class="p">,</span> <span class="n">pool</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>La méthode <code>run</code> remplace la fonction principale qu&#8217;on avait dans nos
scripts jusqu&#8217;ici. En écrivant l&#8217;article, je vois que la méthode <code>display</code>
me dérange : elle ne repose sur aucun membre, elle serait donc mieux dans
une classe à part entière.</p>

<p>Voilà, c&#8217;est un peu court en explication comme article et je m&#8217;en excuse
mais aujourd&#8217;hui je suis très préssé. La prochaine fois on parle des classes
<code>MatingPool</code>, <code>Crossover</code> et <code>Mutator</code>.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/20/les-algorithmes-genetiques-demystifies-19/'>Les algorithmes génétiques démystifiés 19</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/18/les-algorithmes-genetiques-demystifies-17-oriente-objet/'>Les algorithmes génétiques démystifiés 17: Orienté Objet</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/17/les-algorithmes-genetiques-demystifies-16-le-hill-climbing/'>Les algorithmes génétiques démystifiés 16: Le Hill-Climbing</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 17: Orienté Objet]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/18/les-algorithmes-genetiques-demystifies-17-oriente-objet/"/>
    <updated>2013-09-18T10:06:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/18/les-algorithmes-genetiques-demystifies-17-oriente-objet</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>Il est temps de donner du code orienté objet, non ? C&#8217;est ce à quoi je vais
m&#8217;attacher dans cet article et les quelques qui suivront. Après ça, je
pense qu&#8217;on pourra en finir avec le paradoxe du singe savant et passer à
quelque chose de plus intéressant.</p>

<!-- more -->


<p>Aujourd&#8217;hui on voit la création de la population selon le paradigme OO.
Il nous faut d&#8217;abord pouvoir créer un individu:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Individual</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="kp">nil</span><span class="p">,</span> <span class="n">chromosome_size</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_chromosome</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>    <span class="kp">new</span><span class="p">(</span><span class="n">chromosome</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">attr_accessor</span> <span class="ss">:score</span><span class="p">,</span> <span class="ss">:fitness</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:chromosome</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">chromosome_size</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">chromosome</span>
</span><span class='line'>      <span class="vi">@chromosome</span> <span class="o">=</span> <span class="n">chromosome</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@chromosome</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>      <span class="n">chromosome_size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="vi">@chromosome</span> <span class="o">+=</span> <span class="no">Gene</span><span class="o">.</span><span class="n">random</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="nb">private_class_method</span> <span class="ss">:new</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Il y a deux manières de créer un individu. Lors de l&#8217;initialisation de
la population, on utilisera <code>Individual.random</code> avec la taille du chromosome.
Lors d&#8217;un accouplement, on utilisera <code>Individual.from_chromosome</code> avec le
chromosome résultant des parents. On note aussi les deux attributs <code>score</code>
et <code>fitness</code>. Je ne vais pas m&#8217;étaler sur le <code>score</code>, 1 point par lettre
bien placée, voilà, vous avez compris. Par contre <code>fitness</code> demande
quelques explications puisque c&#8217;est la première fois que j&#8217;emploie ce terme,
pourtant courant en algorithme génétique.</p>

<p><em>Fitness</em> signifie aptitude. Quand le score mesure la performance d&#8217;un
individu face à un problème, le <em>fitness</em> mesure un individu par rapport
à son environnement, c&#8217;est à dire ici par rapport à la population. Il n&#8217;y
a rien de nouveau, on a déjà fait ça quand on normalisait les scores et
qu&#8217;on les transformaient en pourcentage (ou en fraction). Jusqu&#8217;ici
j&#8217;étais resté vague en parlant seulement d&#8217;évaluation et je profite du
code d&#8217;aujourd&#8217;hui pour introduire cette notion de <em>fitness</em>.</p>

<p>La production d&#8217;un gène est assurée par la classe <code>Gene</code>, qui ne demande
pas d&#8217;explications:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Gene</span>
</span><span class='line'>  <span class="vc">@@genes</span> <span class="o">=</span> <span class="s2">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ &quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">random</span>
</span><span class='line'>    <span class="vc">@@genes</span><span class="o">[</span><span class="nb">rand</span><span class="p">(</span><span class="vc">@@genes</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Il reste à concevoir la population:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Population</span> <span class="o">&lt;</span> <span class="nb">Array</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">,</span> <span class="n">population_size</span><span class="p">)</span>
</span><span class='line'>    <span class="n">population_size</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="nb">self</span> <span class="o">&lt;&lt;</span> <span class="no">Individual</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">chromosome_size</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">best</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">{</span><span class="o">|</span><span class="n">individual</span><span class="o">|</span> <span class="n">individual</span><span class="o">.</span><span class="n">score</span><span class="p">}</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>La population étant basiquement une liste d&#8217;objets <code>Individual</code>, il me
semble logique d&#8217;hériter de <code>Array</code>. J&#8217;ai prévu une méthode <code>best</code> qui
permettra d&#8217;afficher la progression de l&#8217;algorithme et qui pourra aussi
servir pour la condition d&#8217;arrêt du programme quand <code>individual.score</code>
sera égal à la taille de la chaîne recherchée.</p>

<p>Demain ce sera au tour de l&#8217;évaluation d&#8217;être transformée en code objet.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/20/les-algorithmes-genetiques-demystifies-19/'>Les algorithmes génétiques démystifiés 19</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/19/les-algorithmes-genetiques-demystifies-18/'>Les algorithmes génétiques démystifiés 18</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/17/les-algorithmes-genetiques-demystifies-16-le-hill-climbing/'>Les algorithmes génétiques démystifiés 16: Le Hill-Climbing</a></li></ul></section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Les algorithmes génétiques démystifiés 16: Le Hill-Climbing]]></title>
    <link href="http://lkdjiin.github.io/blog/2013/09/17/les-algorithmes-genetiques-demystifies-16-le-hill-climbing/"/>
    <updated>2013-09-17T10:50:00+02:00</updated>
    <id>http://lkdjiin.github.io/blog/2013/09/17/les-algorithmes-genetiques-demystifies-16-le-hill-climbing</id>
    <content type="html"><![CDATA[<div class='level-tag level-tag-2'>Niveau : <span>intermédiaire</span></div>


<p>J&#8217;aime les algorithmes génétiques. Je les trouvent fascinants. Mais je ne
voudrais pas laisser croire qu&#8217;ils sont toujours <em>la</em> solution.
Aujourd&#8217;hui je parle de l&#8217;algorithme <em>Hill-Climbing</em>, qu&#8217;on peut considérer
comme un algorithme génétique dégénéré.</p>

<!-- more -->


<h2>Hill-Climbing</h2>

<p>Pourquoi dégénéré ? Parce que le <em>Hill-Climbing</em> est essentiellement un
algorithme génétique sans population et sans croisement… Le principe est
très simple: on produit une solution au hasard, puis on mute cette solution
en espérant qu&#8217;elle soit meilleure que la précédente. Dit comme ça, cela
semble un peu aventureux. Mais parfois, suivant le problème posé, ça
fonctionne vraiment bien. Gardons le thème des articles précédents,
c&#8217;est à dire le paradoxe du singe savant. On cherche toujours la même phrase,
à savoir «Mon royaume pour un cheval». C&#8217;est parti pour le code.</p>

<h3>Le code</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">make_chromosome</span>
</span><span class='line'>  <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>  <span class="n">length</span> <span class="o">=</span> <span class="vi">@search_value</span><span class="o">.</span><span class="n">size</span>
</span><span class='line'>  <span class="n">length</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="n">value</span> <span class="o">+=</span> <span class="n">random_gene</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">value</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">random_gene</span>
</span><span class='line'>  <span class="vi">@genes</span><span class="o">[</span><span class="nb">rand</span><span class="p">(</span><span class="vi">@genes</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">phrase</span><span class="p">)</span>
</span><span class='line'>  <span class="n">index</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="vi">@search_value</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</span><span class='line'>  <span class="n">phrase</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="n">random_gene</span>
</span><span class='line'>  <span class="n">phrase</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">quality</span><span class="p">(</span><span class="n">phrase</span><span class="p">)</span>
</span><span class='line'>  <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="n">phrase</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">character</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span><span class='line'>    <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="vi">@search_value</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">==</span> <span class="n">character</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">score</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@search_value</span> <span class="o">=</span> <span class="s2">&quot;Mon royaume pour un cheval&quot;</span>
</span><span class='line'><span class="vi">@genes</span> <span class="o">=</span> <span class="s2">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ &quot;</span>
</span><span class='line'><span class="vi">@solution</span> <span class="o">=</span> <span class="n">make_chromosome</span>
</span><span class='line'><span class="vi">@generation</span> <span class="o">=</span> <span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>On a besoin de produire une phrase au hasard, que je continue à appeler
<em>chromosome</em>, et c&#8217;est la méthode <code>make_chromosome</code> qui s&#8217;en charge.
On a besoin de modifier une phrase, je continue à dire <em>muter</em>, et c&#8217;est
bien sûre le rôle de <code>mutate</code>. Enfin, on doit pouvoir évaluer la qualité
d&#8217;une phrase, avec <code>quality</code>. Rien de vraiment nouveau sous le soleil, ça
ressemble furieusement au code développé pour l&#8217;algorithme génétique
précédent.
On peut noter avec intérêt la ligne <code>@solution = make_chromosome</code>. Ici, on
ne parle pas d&#8217;individus puisqu&#8217;il n&#8217;y a pas de population.</p>

<p>Et maintenant le <em>Hill-Climbing</em> proprement dit. Attention les yeux, ça va
être rapide:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Hill-Climbing</span>
</span><span class='line'><span class="k">until</span> <span class="vi">@solution</span> <span class="o">==</span> <span class="vi">@search_value</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">opponent</span> <span class="o">=</span> <span class="n">mutate</span><span class="p">(</span><span class="vi">@solution</span><span class="o">.</span><span class="n">dup</span><span class="p">)</span>
</span><span class='line'>  <span class="vi">@solution</span> <span class="o">=</span> <span class="n">opponent</span> <span class="k">if</span> <span class="n">quality</span><span class="p">(</span><span class="n">opponent</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">quality</span><span class="p">(</span><span class="vi">@solution</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Gen: </span><span class="si">#{</span><span class="vi">@generation</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="vi">@solution</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="vi">@generation</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Et voilà. Pas de population, pas de reproduction, pas de <em>mating pool</em>. Juste
une mutation et une comparaison de qualité. Mais est-ce que ça fonctionne ?</p>

<pre><code>[~/genetic]⇒ time ruby monkey_hill.rb
Gen: 0    CwAEKaVBHW nTVWIsvhnwODtaL
...
Gen: 449  CwAEKoVaHW  TouI vh wODtal
...
Gen: 1446 Mnn royaiueUpoustun chFvml
...
Gen: 4652 Mon royaume popr un cheval
Gen: 4653 Mon royaume pour un cheval

real  0m0.598s
user  0m0.572s
sys   0m0.024s
</code></pre>

<p>Un grand nombre de générations par rapport à l&#8217;algorithme génétique mais
un temps de calcul bien plus court (pour ce problème particulier).</p>

<h3>Moralité</h3>

<p>Avant de se jeter dans l&#8217;écriture d&#8217;un algorithme génétique, il est
intéressant d&#8217;écrire d&#8217;abord un <em>Hill-Climbing</em>. Parfois on n&#8217;a pas
besoin de plus, parfois ça permet de valider la fonction d&#8217;évaluation.</p>

<p>À demain.</p>

<p><section><h1>Articles connexes</h1><ul><li><a href='http://lkdjiin.github.io/blog/2013/09/20/les-algorithmes-genetiques-demystifies-19/'>Les algorithmes génétiques démystifiés 19</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/19/les-algorithmes-genetiques-demystifies-18/'>Les algorithmes génétiques démystifiés 18</a></li><li><a href='http://lkdjiin.github.io/blog/2013/09/18/les-algorithmes-genetiques-demystifies-17-oriente-objet/'>Les algorithmes génétiques démystifiés 17: Orienté Objet</a></li></ul></section></p>
]]></content>
  </entry>
  
</feed>
